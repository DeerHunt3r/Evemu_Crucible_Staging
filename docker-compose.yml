services:
  server:
    build: .  # Build image from local source repository
    container_name: evemu_server
    volumes:
      - config:/app/etc
      - server_cache:/app/server_cache
      - image_cache:/app/image_cache
      - logs:/app/logs        # optional but very handy
    ports:
      - "26000:26000"
      - "26001:26001"
    depends_on:
      - db
    environment:
      # choose ONE default set; I'm using your "80% / 4 regions" values since those
      # were last in your current file and therefore what you've actually been running
      - SEED_MARKET=${SEED_MARKET:-TRUE}
      - SEED_SATURATION=${SEED_SATURATION:-80}
      - SEED_REGIONS=${SEED_REGIONS:-Derelik,The Citadel,The Forge,Essence,Verge Vendor,Everyshore,Tash-Murkon,Sinq Liason}
      - RUN_WITH_GDB=${RUN_GDB:-FALSE}
    stdin_open: true  # Enables stdin for the container. Attach to it with 'docker attach'
    tty: true
    cap_add:
      - SYS_PTRACE         # Required for gdb

  db:
    image: "bitnami/mariadb:latest"
    container_name: evemu_db
    volumes:
      - evemu_mariadb:/bitnami
    ports:
      - "3306:3306"
    environment:
      - ALLOW_EMPTY_PASSWORD=yes
      - MARIADB_USER=evemu
      - MARIADB_PASSWORD=evemu_root_pass123
      - MARIADB_DATABASE=evemu

volumes:
  evemu_mariadb:
  config:
  server_cache:
  image_cache:
  logs:
